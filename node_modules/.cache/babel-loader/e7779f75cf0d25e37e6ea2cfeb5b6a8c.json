{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _lodash = require(\"lodash\");\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _core = require(\"@buffetjs/core\");\n\nvar _custom = require(\"@buffetjs/custom\");\n\nvar _utils = require(\"../../utils\");\n\nvar _pluginId = _interopRequireDefault(require(\"../../pluginId\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nvar ImportModal = function ImportModal(_ref) {\n  var isOpen = _ref.isOpen,\n      onToggle = _ref.onToggle,\n      onImport = _ref.onImport,\n      value = _ref.value;\n\n  var _useGlobalContext = (0, _strapiHelperPlugin.useGlobalContext)(),\n      formatMessage = _useGlobalContext.formatMessage;\n\n  var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(''),\n      _useState4 = (0, _slicedToArray2[\"default\"])(_useState3, 2),\n      inputError = _useState4[0],\n      setInputError = _useState4[1];\n\n  var _useState5 = (0, _react.useState)(''),\n      _useState6 = (0, _slicedToArray2[\"default\"])(_useState5, 2),\n      url = _useState6[0],\n      setUrl = _useState6[1];\n\n  var abortController = new AbortController();\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref2 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee() {\n      var signal, data;\n      return _regenerator[\"default\"].wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setIsLoading(true);\n              signal = abortController.signal;\n              _context.prev = 2;\n              setInputError('');\n              _context.next = 6;\n              return (0, _strapiHelperPlugin.request)((0, _utils.getRequestUrl)(\"fetch?url=\".concat(encodeURIComponent(url)), {\n                method: 'GET',\n                signal: signal\n              }));\n\n            case 6:\n              data = _context.sent;\n              setIsLoading(false);\n\n              if (data.error) {\n                setInputError(data.error);\n              } else {\n                onImport(data);\n                onToggle();\n              }\n\n              _context.next = 15;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](2);\n              setInputError(_context.t0.message);\n              setIsLoading(false);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 11]]);\n    }));\n\n    return function onSubmit() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  (0, _react.useEffect)(function () {\n    if (isOpen) {\n      setUrl((0, _lodash.isObject)(value) && value.url ? value.url : ''); // Focus on the input\n\n      setTimeout(function () {\n        var input = document.getElementById('oembed-form-url');\n\n        if (input) {\n          input.focus();\n        }\n      }, 150);\n    }\n\n    return function () {\n      // Abort the endpoint call if we close the modal\n      abortController.abort();\n    };\n  }, [isOpen]); // Submit when we hit enter on the input\n\n  var keyPress = function keyPress(e) {\n    if (e.keyCode === 13) {\n      e.preventDefault();\n      onSubmit();\n    }\n  };\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.Modal, {\n    isOpen: isOpen,\n    onToggle: onToggle,\n    style: {\n      width: '50rem'\n    }\n  }, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.HeaderModal, null, /*#__PURE__*/_react[\"default\"].createElement(\"section\", null, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.HeaderModalTitle, {\n    style: {\n      textTransform: 'none'\n    }\n  }, /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: \"\".concat(_pluginId[\"default\"], \".modal.import.title\")\n  })))), /*#__PURE__*/_react[\"default\"].createElement(\"form\", null, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.ModalBody, null, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.ModalForm, {\n    style: {\n      padding: '0 15px'\n    }\n  }, /*#__PURE__*/_react[\"default\"].createElement(_custom.Inputs, {\n    id: \"oembed-form-url\",\n    label: formatMessage({\n      id: (0, _utils.getTrad)('modal.import.input.label')\n    }),\n    description: formatMessage({\n      id: (0, _utils.getTrad)('modal.import.input.description')\n    }),\n    validations: {\n      required: true\n    },\n    onChange: function onChange(_ref3) {\n      var value = _ref3.target.value;\n      setUrl(value);\n    },\n    onKeyDown: keyPress,\n    error: inputError,\n    name: \"name\",\n    type: \"text\",\n    value: url\n  }))), /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.ModalFooter, null, /*#__PURE__*/_react[\"default\"].createElement(\"section\", null, /*#__PURE__*/_react[\"default\"].createElement(_core.Button, {\n    onClick: onToggle,\n    color: \"cancel\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: \"app.components.Button.cancel\"\n  })), /*#__PURE__*/_react[\"default\"].createElement(_core.Button, {\n    color: \"success\",\n    isLoading: isLoading,\n    onClick: onSubmit\n  }, /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: \"\".concat(_pluginId[\"default\"], \".modal.import.button.import\")\n  }))))));\n};\n\nImportModal.defaultProps = {\n  value: {}\n};\nImportModal.propTypes = {\n  isOpen: _propTypes[\"default\"].bool.isRequired,\n  onToggle: _propTypes[\"default\"].func.isRequired,\n  onImport: _propTypes[\"default\"].func.isRequired,\n  value: _propTypes[\"default\"].object\n};\nvar _default = ImportModal;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/home/zenack/Trabajo/Strapi-concept/.cache/plugins/strapi-plugin-oembed/admin/src/components/ImportModal/index.js"],"names":["ImportModal","isOpen","onToggle","onImport","value","formatMessage","isLoading","setIsLoading","inputError","setInputError","url","setUrl","abortController","AbortController","onSubmit","signal","encodeURIComponent","method","data","error","message","setTimeout","input","document","getElementById","focus","abort","keyPress","e","keyCode","preventDefault","width","textTransform","pluginId","padding","id","required","target","defaultProps","propTypes","PropTypes","bool","isRequired","func","object"],"mappings":"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","sourcesContent":["\nimport React, { useEffect, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { isObject } from 'lodash';\nimport {\n  HeaderModal,\n  HeaderModalTitle,\n  Modal,\n  ModalBody,\n  ModalFooter,\n  ModalForm,\n  useGlobalContext,\n  request,\n} from 'strapi-helper-plugin';\nimport { FormattedMessage } from 'react-intl';\nimport { Button } from '@buffetjs/core';\nimport { Inputs } from '@buffetjs/custom';\nimport { getTrad, getRequestUrl } from '../../utils';\nimport pluginId from '../../pluginId';\n\nconst ImportModal = ({\n  isOpen,\n  onToggle,\n  onImport,\n  value,\n}) => {\n  const { formatMessage } = useGlobalContext();\n  const [isLoading, setIsLoading] = useState(false);\n  const [inputError, setInputError] = useState('');\n  const [url, setUrl] = useState('');\n  const abortController = new AbortController();\n\n  const onSubmit = async () => {\n    setIsLoading(true);\n    const { signal } = abortController;\n\n    try {\n      setInputError('');\n      const data = await request(getRequestUrl(`fetch?url=${encodeURIComponent(url)}`, { method: 'GET', signal }));\n      setIsLoading(false);\n\n      if (data.error) {\n        setInputError(data.error);\n      } else {\n        onImport(data);\n        onToggle();\n      }\n\n    } catch (error) {\n      setInputError(error.message);\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (isOpen) {\n      setUrl(isObject(value) && value.url ? value.url : '');\n\n      // Focus on the input\n      setTimeout(() => {\n        const input = document.getElementById('oembed-form-url');\n        if (input) {\n          input.focus();\n        }\n      }, 150);\n    }\n\n    return () => {\n      // Abort the endpoint call if we close the modal\n      abortController.abort();\n    };\n  }, [isOpen]);\n\n  // Submit when we hit enter on the input\n  const keyPress = (e) => {\n    if (e.keyCode === 13){\n      e.preventDefault();\n      onSubmit();\n    }\n  }\n\n  return (\n    <Modal isOpen={isOpen} onToggle={onToggle} style={{ width: '50rem' }}>\n      <HeaderModal>\n        <section>\n          <HeaderModalTitle style={{ textTransform: 'none' }}>\n            <FormattedMessage id={`${pluginId}.modal.import.title`} />\n          </HeaderModalTitle>\n        </section>\n      </HeaderModal>\n      <form>\n        <ModalBody>\n          <ModalForm style={{ padding: '0 15px' }}>\n            <Inputs\n              id=\"oembed-form-url\"\n              label={formatMessage({\n                id: getTrad('modal.import.input.label'),\n              })}\n              description={formatMessage({\n                id: getTrad('modal.import.input.description'),\n              })}\n              validations={{\n                required: true\n              }}\n              onChange={({ target: { value } }) => {\n                setUrl(value);\n              }}\n              onKeyDown={keyPress}\n              error={inputError}\n              name=\"name\"\n              type=\"text\"\n              value={url}\n            />\n            </ModalForm>\n        </ModalBody>\n        <ModalFooter>\n          <section>\n            <Button onClick={onToggle} color=\"cancel\">\n              <FormattedMessage id=\"app.components.Button.cancel\" />\n            </Button>\n            <Button color=\"success\" isLoading={isLoading} onClick={onSubmit}>\n              <FormattedMessage id={`${pluginId}.modal.import.button.import`} />\n            </Button>\n          </section>\n        </ModalFooter>\n      </form>\n    </Modal>\n  );\n};\n\nImportModal.defaultProps = {\n  value: {},\n};\n\nImportModal.propTypes = {\n  isOpen: PropTypes.bool.isRequired,\n  onToggle: PropTypes.func.isRequired,\n  onImport: PropTypes.func.isRequired,\n  value: PropTypes.object,\n};\n\nexport default ImportModal;"]},"metadata":{},"sourceType":"script"}